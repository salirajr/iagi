<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Akad <small>.Aparkost</small></h5>
                </div>
                <div class="ibox-content">
                    <form method="get" class="form-horizontal" name="covenantForm" >
                        <h3>Pihak Pertama <small>PT. Ibnu Auf Global Investama</small></h3>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Pemangku Kuasa</label>
                            <div class="col-sm-4">
                                <select class="form-control m-b" ng-init="cStaff.id === dInput.selectedCStaffId" ng-change="selectCStaff()" ng-model="dInput.selectedCStaffId" ng-options="cStaff.id as cStaff.fullName for cStaff in data.covenantStaff"></select>
                            </div>
                        </div>
                        <div class="form-group m-b-none">
                            <span class="col-sm-2 control-label"></span>
                            <div class="col-sm-4"><span class="help-block m-b-none"><small>Nama</small></span><p class="form-control-static">{{data.acquisition.staff.fullName}}</p></div>
                            <div class="col-sm-3"><span class="help-block m-b-none"><small>NIK</small></span><p class="form-control-static">{{data.acquisition.staff.nationalId}}</p></div>
                            <div class="col-sm-3"><span class="help-block m-b-none"><small>Jabatan</small></span><p class="form-control-static">{{data.acquisition.staff.rank.name}}</p></div>
                        </div>

                        <div class="form-group m-b-none">
                            <span class="col-sm-2 control-label"></span>
                            <div class="col-sm-4"><span class="help-block m-b-none"><small>TTL</small></span><p class="form-control-static">{{data.acquisition.staff.birthPlace}}, {{data.acquisition.staff.birthDate}}</p></div>
                            <div class="col-sm-6"><span class="help-block m-b-none"><small>Alamat</small></span><p class="form-control-static">{{data.acquisition.staff.address}}</p></div>
                        </div>
                        <h5>Pihak Kedua</h5>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Akun Id </label>
                            <div class="col-lg-3">
                                <div class="input-group">
                                    <input type="text" class="form-control" ng-model="data.acquisition.investor.accountId"  name="accountId" oninput="setCustomValidity('')" oninvalid="this.setCustomValidity('Account Id adalah mandatory')"  required> 
                                    <span class="input-group-btn"> 
                                        <button type="button" class="btn btn-info" ng-click="getAccount()" ><i class="fa fa-check"></i></button> 
                                    </span>
                                </div>

                            </div>

                        </div>

                        <div class="form-group m-b-none">
                            <span class="col-sm-2 control-label"></span>
                            <div class="col-sm-4"><span class="help-block m-b-none"><small>Nama</small></span><p class="form-control-static">{{data.acquisition.investor.fullName}}</p></div>
                            <div class="col-sm-3"><span class="help-block m-b-none"><small>NIK/Passport</small></span><p class="form-control-static">{{data.acquisition.investor.nationalId}}</p></div>
                            <div class="col-sm-3"><span class="help-block m-b-none"><small>Pekerjaan</small></span><p class="form-control-static">{{data.acquisition.investor.occupation}}</p></div>
                        </div>
                        <div class="form-group m-b-none">
                            <span class="col-sm-2 control-label"></span>
                            <div class="col-sm-4"><span class="help-block m-b-none"><small>Kewarganegaraan</small></span><p class="form-control-static">{{data.acquisition.investor.nationality}}</p></div>
                            <div class="col-sm-3"><span class="help-block m-b-none"><small>Email</small></span><p class="form-control-static">{{data.acquisition.investor.emailAddress}}</p></div>
                        </div>

                        <div class="form-group m-b-none">
                            <span class="col-sm-2 control-label"></span>
                            <div class="col-sm-4"><span class="help-block m-b-none"><small>TTL</small></span><p class="form-control-static">{{data.acquisition.investor.birthPlace}}, {{data.acquisition.investor.birthDate}}</p></div>
                            <div class="col-sm-6"><span class="help-block m-b-none"><small>Alamat</small></span><p class="form-control-static">{{data.acquisition.investor.address}}</p></div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-lg-2 control-label"></label>
                            <div class="col-lg-6">
                                <span class="help-block m-b-none"><small>Investasi</small></span>
                                <table class="table table-striped table-bordered table-hover dataTables-example" style="font-size: 85% !important;">
                                    <thead>

                                        <tr>
                                            <th></th>
                                            <th>Unit</th>
                                            <th colspan="2">Harga</th>
                                            <th colspan="2">Harga Pasar</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                            <td align="right" rowspan="2"> </td>
                                            <td align="right"><b>{{data.acquisition.investments.length}} Unit</b></td>
                                            <td align="right">Rp</td>
                                            <td align="right"><b>{{data.acquisition.rate|number:2}}</b></td>
                                            <td align="right">Rp</td>
                                            <td align="right"><b>{{data.acquisition.marketRate|number:2}}</b></td>
                                        </tr>
                                        <tr>
                                            <td align="right" colspan="5" >{{data.selectedSite.name}}, {{data.selectedSite.address}}, {{data.selectedSite.province}}</td>
                                        </tr>
                                    </tfoot>
                                    <tbody>
                                        <tr ng-repeat="cInvestment in data.acquisition.investments"  class="gradeX">
                                            <td class="dt-center"><input type="radio" value="" name="selectedAparkost"></td>
                                            <td>{{cInvestment.aparkost.tower.name}} lt. {{cInvestment.aparkost.floor}} no. {{cInvestment.aparkost.name}}</td>

                                            <td align="center">Rp</td>
                                            <td align="right">{{cInvestment.soldRate|number:2}}</td>
                                            <td align="center">Rp</td>
                                            <td align="right">{{cInvestment.marketRate|number:2}}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>

                        </div>
                        <div class="form-group  m-b-none">
                            <label class="col-sm-2 control-label"></label>
                            <div class="col-sm-4">
                                <span class="help-block m-b-none"><small>Tambahkan</small></span>
                                <select class="form-control m-b" ng-init="site.id === dInput.selectedSiteId" ng-change="selectSite()" ng-model="dInput.selectedSiteId" ng-options="site.id as site.name for site in data.site"></select>
                            </div>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Tower</small></span>
                                <select class="form-control m-b" ng-init="tower.id === dInput.selectedTowerId" ng-change="selectTower()" ng-model="dInput.selectedTowerId" ng-options="tower.id as tower.name for tower in data.tower"></select>
                            </div>

                        </div>
                        <div class="form-group  m-b-none">
                            <label class="col-sm-2 control-label"></label>
                            <div class="col-lg-2">
                                <span class="help-block m-b-none">
                                    <small>Unit</small>
                                </span>
                                <select class="form-control m-b" ng-init="investment.id === dInput.selectedInvestmentId" ng-change="selectInvestment()"  ng-model="dInput.selectedInvestmentId" ng-options="investment.id as investment.aparkost.name for investment in data.investment"></select>
                            </div>
                            <div class="col-lg-2">
                                <span class="help-block m-b-none">
                                    <small>Lantai</small>
                                </span>
                                <input type="text" class="form-control" readonly="" ng-model="data.selectedInvestment.aparkost.floor">
                            </div>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Harga</small></span>
                                <div class="input-group m-b">
                                    <span class="input-group-addon">Rp</span> <input type="text" class="form-control text-right" ng-model="data.selectedInvestment.soldRate" ng-value="data.selectedInvestment.soldRate = data.selectedInvestment.soldRate > 0 ? data.selectedInvestment.soldRate : data.selectedInvestment.marketRate ">
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <span class="help-block m-b-none">
                                    <small>*</small>
                                </span>
                                <button class="btn btn-info " type="submit" ng-click="covenantForm.$valid && addCInvestment()"><i class="fa fa-check"></i></button>
                                <button class="btn btn-warning " type="submit"><i class="fa fa-times"></i></button>
                            </div>
                        </div>
                        <div class="form-group">
                            <span class="col-sm-2 control-label">Pembelian</span>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Tanda Jadi</small></span>
                                <div class="input-group m-b"><span class="input-group-addon">Rp</span> 
                                    <input type="text" class="form-control text-right" ng-model="temp.bookFee" ng-init="temp.bookFee = 0">
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Tanggal</small></span>
                                <div class="input-group date">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control" name="bookDate" ng-model="temp.bookDate" oninvalid="this.setCustomValidity('Tanggal pembayaran tanda jadi adalah mandatory, format YYYY-MM-DD')" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))"  oninput="setCustomValidity('')"   required="">
                                </div>

                            </div>
                        </div>
                        <div class="form-group">
                            <span class="col-sm-2 control-label"></span>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Uang Muka</small></span>
                                <div class="input-group m-b"><span class="input-group-addon">Rp</span> 
                                    <input type="text" class="form-control text-right" ng-model="temp.dpFee" ng-init="temp.dpFee = 0">
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Tanggal </small></span>
                                <div class="input-group date">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control" name="dpPayDate" ng-model="temp.dpDate" oninvalid="this.setCustomValidity('Tanggal pembayaran Uang Muka adalah mandatory, format YYYY-MM-DD')" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))"  oninput="setCustomValidity('')"   required="">
                                </div>
                            </div>
                            <div class="col-sm-3"><span class="help-block m-b-none">
                                    <small>Sisa</small></span>
                                <div class="input-group m-b"><span class="input-group-addon">Rp</span> 
                                    <input type="text" class="form-control text-right" ng-model="data.acquisition.payableFee" ng-value="data.acquisition.payableFee = data.acquisition.rate - temp.bookFee - temp.dpFee" readonly="">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-lg-2 control-label"></label>

                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Metode</small></span>
                                <select class="form-control" ng-init="data.acquisition.type = 'CASH'"  ng-model="data.acquisition.type" ng-change="paymentActivation()" ng-disabled="data.acquisition.payableFee === 0">
                                    <option value="CASH">Kontan</option>
                                    <option value="SOFT_INSTALLMENT">Cicilan Lunak</option>
                                    <option value="INSTALLMENT">Cicilan</option>
                                </select>
                            </div>
                            <div class="col-sm-3"  ng-show="data.acquisition.type === 'CASH'">
                                <span class="help-block m-b-none"><small>Tanggal</small></span>
                                <div class="input-group date">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control"  name="repaymentDate" ng-model="temp.repaymentDate">
                                </div>
                            </div>
                            <div class="col-sm-3"  ng-show="data.acquisition.type === 'INSTALLMENT'">
                                <span class="help-block m-b-none"><small>Tanggal Awalan</small></span>
                                <div class="input-group date">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control"  name="startDate" ng-model="temp.startDate">
                                </div>
                            </div>


                        </div>
                        <div class="form-group"   ng-show="data.acquisition.type === 'SOFT_INSTALLMENT'">
                            <label class="col-lg-2 control-label"></label>

                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Tanggal Awalan</small></span>
                                <div class="input-group date">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control"  name="startDate" ng-model="temp.repaymentDate">
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <span class="help-block m-b-none"><small>Nominal</small></span>
                                <div class="input-group m-b"><span class="input-group-addon">Rp</span> 
                                    <input type="text" class="form-control text-right" ng-model="temp.installmentNominal" ng-init="temp.installmentNominal = 0">
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <span class="help-block m-b-none">
                                    <small>+</small>
                                </span>
                                <button class="btn btn-info " ng-click="addInstallment()" ><i class="fa fa-check"></i></button>
                                <button class="btn btn-warning "><i class="fa fa-times"></i></button>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label"></label>
                            <div class="col-sm-10">
                                <button class="btn btn-default" type="submit" ng-click="covenantForm.$valid && saveAcquisition()">Simpan</button>
                                <button class="btn btn-primary" type="submit" ng-click="covenantForm.$valid && generateAkad()" >Simpan dan Cetak</button>
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                        <div class="form-group  m-b-none">
                            <label class="col-lg-1 control-label"></label>

                            <div class="form-group  m-b-none">
                                <label class="col-lg-1 control-label"></label>
                                <div class="col-lg-4">
                                    <span class="help-block m-b-none"><small>Tahapan Pembayaran</small></span>
                                    <table class="table table-striped table-bordered table-hover dataTables-example" style="font-size: 85% !important;">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>Tahap</th>
                                                <th>Tanggal</th>
                                                <th colspan="2">Nominal</th>
                                            </tr>
                                        </thead>
                                        <tfoot>
                                            <tr class="gradeX" >
                                                <td colspan="3">Total</td>
                                                <td>Rp</td>
                                                <td align="right">{{data.acquisition.payableFee|number:2}}</td>
                                            </tr>
                                        </tfoot>

                                        <tbody>
                                            <tr class="gradeX" ng-show="data.acquisition.type === 'CASH'">
                                                <td><input type="radio" value="" name="selectedAparkost"></td>
                                                <td>Lunas</td>
                                                <td>{{temp.repaymentDate}}</td>
                                                <td>Rp</td>
                                                <td align="right">{{data.acquisition.payableFee|number:2}}</td>
                                            </tr>
                                            <tr class="gradeX" ng-show="data.acquisition.type === 'INSTALLMENT' || data.acquisition.type === 'SOFT_INSTALLMENT'" ng-repeat="payment in temp.payments" >
                                                <td><input type="radio" value="" name="selectedAparkost"></td>
                                                <td>{{payment.type}}</td>
                                                <td>{{payment.paydate}}</td>
                                                <td>Rp</td>
                                                <td align="right">{{payment.nominal|number:2}}</td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-lg-5">
                                    <span class="help-block  m-b-none"><small>Simulasi Pembayaran</small></span>
                                    <table class="table table-striped table-bordered table-hover dataTables-example" style="font-size: 85% !important;">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>Tahapan</th>
                                                <th>Tanggal</th>
                                                <th colspan="2">Jumlah</th>
                                            </tr>
                                        </thead>

                                        <tbody>
                                            <tr class="gradeX">
                                                <th></th>
                                                <td>Tanda Jadi</td>
                                                <td>{{temp.bookDate}}</td>
                                                <td>Rp</td>
                                                <td align="right">{{temp.bookFee|number:2}}</td>
                                            </tr>
                                            <tr class="gradeX">
                                                <th></th>
                                                <td>Uang Muka</td>
                                                <td>{{temp.dpPayDate}}</td>
                                                <td>Rp</td>
                                                <td align="right">{{temp.dpFee|number:2}}</td>
                                            </tr>
                                            <tr class="gradeX">
                                                <th></th>
                                                <td colspan="2">Hutang Pembayaran</td>
                                                <td>Rp</td>
                                                <td align="right">{{data.acquisition.payableFee|number:2}}</td>
                                            </tr>
                                            <tr class="gradeX">
                                                <th></th>
                                                <td colspan="2">Total</td>
                                                <td>Rp</td>
                                                <td align="right">{{data.acquisition.rate|number:2}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>




                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
